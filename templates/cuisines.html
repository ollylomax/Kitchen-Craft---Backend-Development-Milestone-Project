{% extends 'base.html' %}
{% block content %}

<section>

  <!-- Flash messages -->
  {% with messages = get_flashed_messages() %}
  {% if messages %}
  {% for message in messages %}
  <div class="row flash-panel green">
    <h2 class="white-text center-align"><i class="fa-solid fa-check"></i><br>{{ message }}</h2>
  </div>
  {% endfor %}
  {% endif %}
  {% endwith %}

</section>

<div class="row">
  <div class="col s12 center-align title-footer">
    <h1>Read about all the cuisines of the world below</h1>
    {% if session.user_session %}
    {% if username.is_admin == 'yes' %}
    <p class="center-align">
      <a href="{{ url_for('add_cuisine', username=session['user_session']) }}"
        class="col s12 btn-small purple darken-1">Add Cuisine</a>
    </p>
    {% endif %}
    {% endif %}
  </div>
</div>

<ul class="collection cuisines">
  {% for cuisine in cuisines %}
  <li class="collection-item avatar">
    <img src="data:image/png;base64,{{ cuisine.flag }}" alt="flag for {{ cuisine.cuisine_name }}" 
    class="circle tooltipped" data-tooltip="{{ cuisine.cuisine_name }}">
    {% if cuisine.cuisine_of_week == 'yes' %}
    <i class="fa-solid fa-star right tooltipped" data-tooltip="Cuisine of the Week"></i>
    {% endif %}
    <span class="title">{{ cuisine.cuisine_name }}</span>
    <p>{{ cuisine.description }}
    </p>

    {% if session.user_session %}
    {% if username.is_admin == 'yes' %}
    <div class="col s12 right-align">
      <a href="{{ url_for('edit_cuisine', username=session['user_session'], cuisine_id=cuisine._id) }}"
        class="btn-small green">Edit</a>
      <a href="#modal-{{ cuisine._id }}" class="btn-small red modal-trigger">Remove</a>
    </div>
    {% endif %}
    {% endif %}
  </li>

  <!-- Modal Structure -->
  <div id="modal-{{ cuisine._id }}" class="modal purple darken-4">
    <div class="modal-content white-text">
      <h4>Confirm Deletion</h4>
      <p>Are you sure you want to permanently delete this cuisine?</p>
    </div>
    <div class="modal-footer grey lighten-2">
      <a href="{{ url_for('cuisines', username=session['user_session']) }}" class="btn-small green">Return</a>
      <a href="{{ url_for('remove_cuisine', cuisine_id=cuisine._id) }}" class="modal-close btn-small red">Confirm
        Delete</a>
    </div>
  </div>
  </div>

  {% endfor %}
</ul>
{% if session.user_session %}
{% if username.is_admin == 'yes' %}
<div class="row">
  <div class="col s12 center-align">
    <p class="center-align">
      <a href="{{ url_for('add_cuisine', username=session['user_session']) }}"
        class="col s12 btn-small purple darken-1">Add Cuisine</a>
    </p>
  </div>
</div>
{% endif %}
{% endif %}

{% endblock %}